Name                        | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Description                                                                                              | Sensitive | Default
--------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------- | --------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ibmcloud_api_key          | string                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | The IBM Cloud platform API key needed to deploy IAM enabled resources                                    | true      | 
TF_VERSION                | string                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | The version of the Terraform engine that's used in the Schematics workspace.                             |           | 1.0
prefix                    | string                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | A unique identifier need to provision resources. Must begin with a letter                                |           | gcat-multizone-schematics
region                    | string                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Region where VPC will be created                                                                         |           | us-south
resource_group            | string                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Name of resource group where all infrastructure will be provisioned.                                     |           | 
tags                      | list(string)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | List of tags to apply to resources created by this module.                                               |           | []
vpcs                      | list( object({ prefix = string use_manual_address_prefixes = optional(bool) classic_access = optional(bool) default_network_acl_name = optional(string) default_security_group_name = optional(string) default_routing_table_name = optional(string) address_prefixes = optional( object({ zone-1 = optional(list(string)) zone-2 = optional(list(string)) zone-3 = optional(list(string)) }) ) network_acls = list( object({ name = string network_connections = optional(list(string)) add_cluster_rules = optional(bool) rules = list( object({ name = string action = string destination = string direction = string source = string tcp = optional( object({ port_max = optional(number) port_min = optional(number) source_port_max = optional(number) source_port_min = optional(number) }) ) udp = optional( object({ port_max = optional(number) port_min = optional(number) source_port_max = optional(number) source_port_min = optional(number) }) ) icmp = optional( object({ type = optional(number) code = optional(number) }) ) }) ) }) ) use_public_gateways = object({ zone-1 = optional(bool) zone-2 = optional(bool) zone-3 = optional(bool) }) subnets = object({ zone-1 = list(object({ name = string cidr = string public_gateway = optional(bool) acl_name = string })) zone-2 = list(object({ name = string cidr = string public_gateway = optional(bool) acl_name = string })) zone-3 = list(object({ name = string cidr = string public_gateway = optional(bool) acl_name = string })) }) }) ) | A map describing VPCs to be created in this repo                                                         |           | [<br>{<br>prefix = "management"<br>use_public_gateways = {<br>zone-1 = true<br>zone-2 = true<br>zone-3 = true<br>}<br>network_acls = [<br>{<br>name = "vpc-acl"<br>add_cluster_rules = true<br>rules = [<br>{<br>name = "allow-all-inbound"<br>action = "allow"<br>direction = "inbound"<br>destination = "0.0.0.0/0"<br>source = "0.0.0.0/0"<br>},<br>{<br>name = "allow-all-outbound"<br>action = "allow"<br>direction = "outbound"<br>destination = "0.0.0.0/0"<br>source = "0.0.0.0/0"<br>}<br>]<br>}<br>]<br>subnets = {<br>zone-1 = [<br>{<br>name = "subnet-a"<br>cidr = "10.10.10.0/24"<br>public_gateway = true<br>acl_name = "vpc-acl"<br>}<br>],<br>zone-2 = [<br>{<br>name = "subnet-b"<br>cidr = "10.20.10.0/24"<br>public_gateway = true<br>acl_name = "vpc-acl"<br>}<br>],<br>zone-3 = [<br>{<br>name = "subnet-c"<br>cidr = "10.30.10.0/24"<br>public_gateway = true<br>acl_name = "vpc-acl"<br>}<br>]<br>}<br>},<br>{<br>prefix = "workload"<br>use_public_gateways = {<br>zone-1 = true<br>zone-2 = true<br>zone-3 = true<br>}<br>network_acls = [<br>{<br>name = "vpc-acl"<br>add_cluster_rules = true<br>rules = [<br>{<br>name = "allow-all-inbound"<br>action = "allow"<br>direction = "inbound"<br>destination = "0.0.0.0/0"<br>source = "0.0.0.0/0"<br>},<br>{<br>name = "allow-all-outbound"<br>action = "allow"<br>direction = "outbound"<br>destination = "0.0.0.0/0"<br>source = "0.0.0.0/0"<br>}<br>]<br>}<br>]<br>subnets = {<br>zone-1 = [<br>{<br>name = "subnet-a"<br>cidr = "10.40.10.0/24"<br>public_gateway = true<br>acl_name = "vpc-acl"<br>}<br>],<br>zone-2 = [<br>{<br>name = "subnet-b"<br>cidr = "10.50.10.0/24"<br>public_gateway = true<br>acl_name = "vpc-acl"<br>}<br>],<br>zone-3 = [<br>{<br>name = "subnet-c"<br>cidr = "10.60.10.0/24"<br>public_gateway = true<br>acl_name = "vpc-acl"<br>}<br>]<br>}<br>}<br>]
ssh_public_key            | string                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Public ssh key to use in VSI provision                                                                   |           | 
vsi                       | list( object({ name = string vpc_name = string subnet_names = list(string) ssh_key_name = optional(string) image_name = string machine_type = string vsi_per_subnet = number security_group = optional( object({ name = string rules = list( object({ name = string direction = string source = string tcp = optional( object({ port_max = number port_min = number }) ) udp = optional( object({ port_max = number port_min = number }) ) icmp = optional( object({ type = number code = number }) ) }) ) }) ) load_balancers = list( object({ name = string type = string listener_port = number listener_protocol = string connection_limit = number algorithm = string protocol = string health_delay = number health_retries = number health_timeout = number health_type = string pool_member_port = string security_group = optional( object({ name = string rules = list( object({ name = string direction = string source = string tcp = optional( object({ port_max = number port_min = number }) ) udp = optional( object({ port_max = number port_min = number }) ) icmp = optional( object({ type = number code = number }) ) }) ) }) ) }) ) }) )                                                                                                                                                                                                                                                                                                                                                            | A list describing VSI workloads to create                                                                |           | [<br>{<br>name = "test-vsi"<br>vpc_name = "management"<br>subnet_names = ["subnet-a",<br>"subnet-c"]<br>image_name = "ibm-centos-7-6-minimal-amd64-2"<br>machine_type = "bx2-8x32"<br>vsi_per_subnet = 2<br>security_group = {<br>name = "test"<br>rules = [<br>{<br>name = "allow-all-inbound"<br>source = "0.0.0.0/0"<br>direction = "inbound"<br>},<br>{<br>name = "allow-all-outbound"<br>source = "0.0.0.0/0"<br>direction = "outbound"<br>}<br>]<br>}<br>load_balancers = [<br>{<br>name = "test"<br>type = "public"<br>listener_port = 80<br>listener_protocol = "http"<br>connection_limit = 0<br>algorithm = "round_robin"<br>protocol = "http"<br>health_delay = 10<br>health_retries = 10<br>health_timeout = 5<br>health_type = "http"<br>pool_member_port = 80<br>}<br>]<br>},<br>{<br>name = "workload-vsi"<br>vpc_name = "workload"<br>subnet_names = ["subnet-a",<br>"subnet-b",<br>"subnet-c"]<br>image_name = "ibm-centos-7-6-minimal-amd64-2"<br>machine_type = "bx2-8x32"<br>vsi_per_subnet = 1<br>security_group = {<br>name = "test"<br>rules = [<br>{<br>name = "allow-all-inbound"<br>source = "0.0.0.0/0"<br>direction = "inbound"<br>},<br>{<br>name = "allow-all-outbound"<br>source = "0.0.0.0/0"<br>direction = "outbound"<br>}<br>]<br>}<br>load_balancers = [<br>{<br>name = "workload"<br>type = "public"<br>listener_port = 80<br>listener_protocol = "http"<br>connection_limit = 0<br>algorithm = "round_robin"<br>protocol = "http"<br>health_delay = 10<br>health_retries = 10<br>health_timeout = 5<br>health_type = "http"<br>pool_member_port = 80<br>}<br>]<br>}<br>]
flow_logs                 | object({ cos_bucket_name = string active = bool use = bool })                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | List of variables for flow log to connect to each VSI instance. Set `use` to false to disable flow logs. |           | {<br>cos_bucket_name = "jv-dev-bucket"<br>active = true<br>use = true<br>}
security_groups           | list( object({ name = string vpc_name = string rules = list( object({ name = string direction = string source = string tcp = optional( object({ port_max = number port_min = number }) ) udp = optional( object({ port_max = number port_min = number }) ) icmp = optional( object({ type = number code = number }) ) }) ) }) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Security groups for VPE                                                                                  |           | [<br>{<br>name = "workload-vpe"<br>vpc_name = "workload"<br>rules = [<br>{<br>name = "allow-all-inbound"<br>source = "0.0.0.0/0"<br>direction = "inbound"<br>},<br>{<br>name = "allow-all-outbound"<br>source = "0.0.0.0/0"<br>direction = "outbound"<br>}<br>]<br>}<br>]
virtual_private_endpoints | list( object({ service_name = string service_crn = string vpcs = list( object({ name = string subnets = list(string) security_group_name = optional(string) }) ) }) )                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Object describing VPE to be created                                                                      |           | [<br>{<br>service_name = "dbaas"<br>service_crn = "1234"<br>vpcs = [<br>{<br>name = "management"<br>subnets = ["subnet-a",<br>"subnet-c"]<br>security_group_name = "workload-vpe"<br>},<br>{<br>name = "workload"<br>subnets = ["subnet-b"]<br>}<br>]<br>},<br>{<br>service_name = "rabbitmq"<br>service_crn = "1234"<br>vpcs = [<br>{<br>name = "management"<br>subnets = ["subnet-a",<br>"subnet-c"]<br>},<br>{<br>name = "workload"<br>subnets = ["subnet-b"]<br>}<br>]<br>}<br>]
